1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?  
  
- В Linux используется ```ip link```
```
mike@Sky:~$ ip -c -br link
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP> 
enp2s0           DOWN           04:d4:c4:e9:45:54 <NO-CARRIER,BROADCAST,MULTICAST,UP> 
wlp4s0           UP             c0:e4:34:1b:bd:2d <BROADCAST,MULTICAST,UP,LOWER_UP> 
vboxnet0         DOWN           0a:00:27:00:00:00 <BROADCAST,MULTICAST> 
ppp1             UNKNOWN        <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP>
```
- В Windows используется ```ipconfig /all```
  
2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?  
```
mike@Sky:~$ lldpctl
-------------------------------------------------------------------------------
LLDP neighbors:
-------------------------------------------------------------------------------
```
  
3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого?  
Приведите пример конфига.
Для разделения L2 коммутатора на несколько виртуальных сетей используется vlan. В Linux используется одноименный пакет - ```vlan```  
  
Независимо от того как настраивается vlan, его использование требует установленного пакета ```vlan```  
```# sudo apt-get install vlan```
  
- Для ```ifconfig``` пример конфига
настройки vlan так же, как и для сетевых интерфейсов, указываются в файле ```/etc/network/interfaces```
```
nano /etc/network/interfaces 
auto vlan1400
iface vlan1400 inet static
        address 192.168.1.1
        netmask 255.255.255.0
        vlan_raw_device eth0
```  
или
```
auto eth0.1400
iface eth0.1400 inet static
        address 192.168.1.1
        netmask 255.255.255.0
        vlan_raw_device eth0
```  

- Для ```netplan``` пример конфига:
```
vlans:
  vlan50:
    id: 50
    link: eth0
    dhcp4: no
    addresses: [192.168.1.2/24]
    gateway: 192.168.1.1
    routes:
        - to: 192.168.1.2/24
         via: 192.168.1.1
         on-link: true
```
- vlans: — объявляем блок настройки vlan.  
- vlan50: — произвольное имя vlan интерфейса.  
- id: — тег нашего vlan.  
- link: — интерфейс через который vlan будет доступен.  
- routes: — объявляем блок описания маршрутов.  
- — to: — задаем адрес/подсеть до которой необходим маршрут.  
- via: — указываем шлюз через которой будет доступна наша подсеть. 
- on-link: — указываем что прописывать маршруты всегда при поднятии линка.  
  
Применение конфигурации — ```sudo netplan apply```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.  

- mode=0 (balance-rr)
Последовательно кидает пакеты, с первого по последний интерфейс.
- mode=1 (active-backup)
Один из интерфейсов активен. Если активный интерфейс выходит из строя (link down и т.д.), другой интерфейс заменяет активный. Не требует дополнительной настройки коммутатора
- mode=2 (balance-xor)
Передачи распределяются между интерфейсами на основе формулы ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. Один и тот же интерфейс работает с определённым получателем. Режим даёт балансировку нагрузки и отказоустойчивость.
- mode=3 (broadcast)
Все пакеты на все интерфейсы
- mode=4 (802.3ad)
Link Agregation — IEEE 802.3ad, требует от коммутатора настройки.
mode=5 (balance-tlb)
Входящие пакеты принимаются только активным сетевым интерфейсом, исходящий распределяется в зависимости от текущей загрузки каждого интерфейса. Не требует настройки коммутатора.
- mode=6 (balance-alb)
Тоже самое что 5, только входящий трафик тоже распределяется между интерфейсами. Не требует настройки коммутатора, но интерфейсы должны уметь изменять MAC.  
  
Подгружаем  проверям модуль ядра bonding
```
# modprobe bonding
# lsmod | grep bonding
bonding               147456  0
```  
   
  
- Пример конфига ```ifconfig```  
```
# The bond0 network interface
auto bond0
allow-hotplug bond0
iface bond0 inet static
address <192.168.1.10>
netmask <255.255.255.0>
network <192.168.1.0>
broadcast <192.168.1.255>
gateway <192.168.1.1>
dns-nameservers <8.8.8.8> <8.8.4.4>
dns-search <domain-name>
up /sbin/ifenslave bond0 eth0
up /sbin/ifenslave bond0 eth1
 
# The bond1 network interface
auto bond1
allow-hotplug bond1
iface bond1 inet static
address <192.168.1.11>
netmask <255.255.255.0>
network <192.168.1.0>
broadcast <192.168.1.255>
gateway <192.168.1.1>
dns-nameservers <8.8.8.8> <8.8.4.4>
dns-search <domain-name>
up /sbin/ifenslave bond1 eth2
up /sbin/ifenslave bond1 eth3
```
  
- Пример конфига для ```netplan```  
```
# nano /etc/netplan/*.yaml
network: 
    renderer: networkd 
    version: 2 
    ethernets: 
        eth0:
          dhcp4: no
        eth1:
          dhcp4: no
    bonds: 
      bond0:
        dhcp4: no
        interfaces: [eth0, eth1]
        parameters:
          mode: 802.3ad
          mii-monitor-interval: 1
bond-slaves eth0 eth1
```  
5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24.  
Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.  
```
mstepanov@Admin:~$ ipcalc 192.168.1.1 /29
Address:   192.168.1.1          11000000.10101000.00000001.00000 001
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Wildcard:  0.0.0.7              00000000.00000000.00000000.00000 111
=>
Network:   192.168.1.0/29       11000000.10101000.00000001.00000 000
HostMin:   192.168.1.1          11000000.10101000.00000001.00000 001
HostMax:   192.168.1.6          11000000.10101000.00000001.00000 110
Broadcast: 192.168.1.7          11000000.10101000.00000001.00000 111
Hosts/Net: 6                     Class C, Private Internet
```
В сети с маской /29 можно получить 6 адресов
  
Из сети /24 можно получить 32 подсети /29, с помощью ipcalc можно посчитать первые три  
```
mstepanov@Admin:~$ ipcalc 10.10.10.0/24 --s 6 6 6
Address:   10.10.10.0           00001010.00001010.00001010. 00000000
Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
=>
Network:   10.10.10.0/24        00001010.00001010.00001010. 00000000
HostMin:   10.10.10.1           00001010.00001010.00001010. 00000001
HostMax:   10.10.10.254         00001010.00001010.00001010. 11111110
Broadcast: 10.10.10.255         00001010.00001010.00001010. 11111111
Hosts/Net: 254                   Class A, Private Internet

1. Requested size: 6 hosts
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
Hosts/Net: 6                     Class A, Private Internet

2. Requested size: 6 hosts
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Network:   10.10.10.8/29        00001010.00001010.00001010.00001 000
HostMin:   10.10.10.9           00001010.00001010.00001010.00001 001
HostMax:   10.10.10.14          00001010.00001010.00001010.00001 110
Broadcast: 10.10.10.15          00001010.00001010.00001010.00001 111
Hosts/Net: 6                     Class A, Private Internet

3. Requested size: 6 hosts
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Network:   10.10.10.16/29       00001010.00001010.00001010.00010 000
HostMin:   10.10.10.17          00001010.00001010.00001010.00010 001
HostMax:   10.10.10.22          00001010.00001010.00001010.00010 110
Broadcast: 10.10.10.23          00001010.00001010.00001010.00010 111
Hosts/Net: 6                     Class A, Private Internet

Needed size:  24 addresses.
Used network: 10.10.10.0/26.999999999999999999999999999999999999999
Unused:
10.10.10.24/29
10.10.10.32/27
10.10.10.64/26
10.10.10.128/25
```

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты.  
Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.  
  
```100.64.0.0/26```
```
mstepanov@Admin:~$ ipcalc 10.64.0.0/10 --s 50
Address:   10.64.0.0            00001010.01 000000.00000000.00000000
Netmask:   255.192.0.0 = 10     11111111.11 000000.00000000.00000000
Wildcard:  0.63.255.255         00000000.00 111111.11111111.11111111
=>
Network:   10.64.0.0/10         00001010.01 000000.00000000.00000000
HostMin:   10.64.0.1            00001010.01 000000.00000000.00000001
HostMax:   10.127.255.254       00001010.01 111111.11111111.11111110
Broadcast: 10.127.255.255       00001010.01 111111.11111111.11111111
Hosts/Net: 4194302               Class A, Private Internet

1. Requested size: 50 hosts
Netmask:   255.255.255.224 = 27 11111111.11111111.11111111.111 00000
Network:   10.64.0.0/27         00001010.01000000.00000000.000 00000
HostMin:   10.64.0.1            00001010.01000000.00000000.000 00001
HostMax:   10.64.0.30           00001010.01000000.00000000.000 11110
Broadcast: 10.64.0.31           00001010.01000000.00000000.000 11111
Hosts/Net: 30                    Class A, Private Internet

Needed size:  64 addresses.
Used network: 10.64.0.0/26
Unused:
10.64.0.64/26
10.64.0.128/25
10.64.1.0/24
10.64.2.0/23
10.64.4.0/22
10.64.8.0/21
10.64.16.0/20
10.64.32.0/19
10.64.64.0/18
10.64.128.0/17
10.65.0.0/16
10.66.0.0/15
10.68.0.0/14
10.72.0.0/13
10.80.0.0/12
10.96.0.0/11
```  

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?  
  
Ubuntu  
```ip neighbour show``` - показать ARP таблицу  
```ip neighbour del [ip address] dev [interface]``` - удалить из ARP таблицы конкретный адрес  
```ip neighbour flush all``` - очищает таблицу ARP  

Windows  
```arp -a``` - показать ARP таблицу  
```arp -d *``` - очистить таблицу ARP  
```arp -d [ip address]``` - удалить из ARP таблицы конкретный адрес  
